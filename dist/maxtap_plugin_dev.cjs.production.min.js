"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("platform");!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}("video[data-displaymaxtap]{height:100%;width:100%}.maxtap_component_wrapper{align-self:flex-end;bottom:75px;display:flex;position:absolute;right:0}.maxtap_main{align-items:center;background-color:rgba(0,0,0,.2);cursor:pointer;display:flex;flex-direction:row;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;justify-content:space-between;z-index:10}.maxtap_main>p{color:#fff;font-family:ubuntu,Roboto,sans-serif,Arial,Helvetica;font-size:calc(1vw + .1rem);font-weight:500;margin-left:.2rem;margin-right:.1rem;padding-left:.4rem}.maxtap_img_wrapper{align-items:center;display:flex;justify-content:center;margin-left:.6rem;padding:.3vw;width:6vw}.maxtap_img_wrapper>img{width:100%}");var t=function(){for(var e=document.querySelectorAll("[data-displaymaxtap]"),t=0;t<e.length;t++)if("VIDEO"===e[t].tagName)return e[t];console.error('Cannot find video element,Please check data attribute. It should be data-displaymaxtap\n                   Example: <video src="https://some_source" data-displaymaxtap > </video> \n                            [OR]\n                   Try to initialize the maxtap_ad component after window load.')};console.log("maxtap_plugin@0.1.31"),exports.Component=function(n){var o=this;this.current_component_index=0,this.init=function(){try{var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id=G-05P2385Q2K",e.async=!0,e.id="G-05P2385Q2K",e.addEventListener("load",(function(){window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-05P2385Q2K")}));var n=document.querySelector("head");if(null==n||n.appendChild(e),o.video=t(),!o.video)return void console.error('Cannot find video element,Please check data attribute. It should be data-displaymaxtap\n            Example: <video src="https://some_source" data-displaymaxtap > </video> \n            [OR]\n            Try to initialize the maxtap_ad component after window load.\n            ');(a=o.content_id,new Promise((function(e,t){try{a.includes(".json")||(a+=".json"),fetch("https://storage.googleapis.com/maxtap-adserver-dev.appspot.com/"+a,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){t.json().then((function(t){t.sort((function(e,t){return parseInt(e.start_time)<parseInt(t.start_time)?-1:parseInt(e.start_time)>parseInt(t.start_time)?1:0})),e(t)}))})).catch((function(e){t(e)}))}catch(e){t(e)}}))).then((function(e){o.components_data=e,o.components_data&&(o.initializeComponent(),document.getElementById("componentmaxtap").addEventListener("click",(function(){o.onComponentClick()})),setInterval((function(){o.updateComponent()}),500))})).catch((function(e){console.error(e)}))}catch(e){console.error(e)}var a},this.updateComponent=function(){if(o.video&&o.components_data){var e=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(t>=o.start_time&&t<=o.end_time)return n}return-1}(o.components_data,o.video.currentTime);e>=0?o.current_component_index=e:o.removeCurrentComponent(),!o.components_data[o.current_component_index].is_image_loaded&&o.components_data[o.current_component_index].start_time-o.video.currentTime<=15&&o.prefetchImage(),o.canCloseComponent(o.video.currentTime)?o.removeCurrentComponent():o.canComponentDisplay(o.video.currentTime)&&o.displayComponent()}else console.error("Cannot find video element with id ")},this.initializeComponent=function(){var e;if(o.video&&(o.video.style.width="100%",o.video.style.height="100%",o.parentElement=o.video.parentElement,o.parentElement)){o.parentElement.style.position="relative";var n=document.createElement("div");n.style.display="none",n.id="componentmaxtap",n.className="maxtap_component_wrapper",null==(e=o.parentElement)||e.appendChild(n);for(var a=0;a<o.components_data.length;a++)o.components_data[a].times_viewed=0,o.components_data[a].times_clicked=0,o.components_data[a].is_image_loaded=!1;o.video=t()}},this.prefetchImage=function(){o.components_data&&(o.components_data[o.current_component_index].is_image_loaded=!0,(new Image).src=o.components_data[o.current_component_index].image_link)},this.canComponentDisplay=function(e){return!!o.components_data&&!(o.components_data[o.current_component_index].start_time<0)&&e<o.components_data[o.current_component_index].end_time&&e>o.components_data[o.current_component_index].start_time},this.canCloseComponent=function(e){return!o.components_data||!(o.components_data[o.current_component_index].start_time<0)&&(e>o.components_data[o.current_component_index].end_time||e<o.components_data[o.current_component_index].start_time)},this.removeCurrentComponent=function(){var e=document.getElementById("componentmaxtap");e&&"none"!==e.style.display&&(e.style.display="none",e.innerHTML="")},this.displayComponent=function(){var t=document.getElementById("componentmaxtap");if(t){var n='\n        <div class="maxtap_main" >\n        <p>'+o.components_data[o.current_component_index].caption_regional_language+'</p>\n        <div class="maxtap_img_wrapper">\n        <img src="'+o.components_data[o.current_component_index].image_link+'"/>\n        </div>\n        </div>\n        ';if("none"===t.style.display){t.style.display="flex",t.innerHTML=n,o.components_data[o.current_component_index].times_viewed++;var a=o.components_data[o.current_component_index],i={event_category:"impression",event_action:"watch",content_id:a.content_id||"null",content_name:a.content_name||"null",product_type:a.article_type||"null",product_category:a.category||"null",product_subcategory:a.subcategory||"null",times_viewed:a.times_viewed||-1,advertiser:"myntra",client_name:a.client_name||"null",start_time:a.start_time||-1,browser_name:e.name||"null",os_family:e.os.family||"null",device_manufacturer:e.manufacturer,os_architecture:e.os.architecture,os_version:e.os.version||"null",screen_resolution:screen.width+"x"+screen.height,screen_orientation:screen.orientation.type};window.gtag("event","impression",i)}}},this.onComponentClick=function(){try{if(!o.components_data)return;o.components_data[o.current_component_index].times_clicked++;var e=o.components_data[o.current_component_index],t={event_category:"action",event_action:"click",content_id:e.content_id||o.content_id,time_to_click:Math.floor(o.video.currentTime-o.components_data[o.current_component_index].start_time),times_clicked:e.times_clicked};window.gtag("event","click",t),window.open(o.components_data[o.current_component_index].redirect_link,"_blank")}catch(e){console.error(e)}},this.content_id=n.content_id,this.parentElement=null};
//# sourceMappingURL=maxtap_plugin_dev.cjs.production.min.js.map
