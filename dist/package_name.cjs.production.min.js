"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Component=function(){function n(n){var e=this;this.current_component_index=0,this.init=function(){var n;if(e.video=document.querySelector("[data-displaymaxtap]"),e.video)try{(n=e.content_id,new Promise((function(e,t){try{n.includes(".json")||(n+=".json"),fetch("https://storage.googleapis.com/maxtap-adserver-dev.appspot.com/"+n,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(n){n.json().then((function(n){n.sort((function(n,e){return parseInt(n.start_time)<parseInt(e.start_time)?-1:parseInt(n.start_time)>parseInt(e.start_time)?1:0})),e(n)}))})).catch((function(n){t(n)}))}catch(n){t(n)}}))).then((function(n){if(e.components_data=n,e.components_data){e.initializeComponent();var t=document.getElementById("componentmaxtap");null==t||t.addEventListener("click",(function(){})),e.interval_id=setInterval((function(){e.updateComponent()}),1e3)}})).catch((function(n){console.error(n)}))}catch(n){console.error(n)}else console.error('Cannot find video element,Please check data attribute. It should be data-displaymaxtap\n            Example: <video src="https://some_source" data-displaymaxtap > </video> \n\n            [OR]\n\n            Try to initialize the maxtap_ad component after window load.\n            ')},this.updateComponent=function(){if(e.video&&e.components_data){var n=e.video.currentTime;e.components_data.forEach((function(t,o){n>=t.start_time&&n<=t.end_time&&(e.current_component_index=o)})),!e.components_data[e.current_component_index].is_image_loaded&&e.components_data[e.current_component_index].start_time-e.video.currentTime<=15&&e.prefetchImage(),e.canComponentDisplay(e.video.currentTime)&&e.displayComponent(),e.canCloseComponent(e.video.currentTime)&&(console.log(e.current_component_index),e.current_component_index++,e.removeCurrentComponent())}else console.error("Cannot find video element with id ")},this.initializeComponent=function(){var n;if(e.video){e.video.style.width="100%",e.video.style.height="100%",e.parentElement=e.video.parentElement;var t=document.createElement("div"),o=document.createElement("div");o.className="maxtap_container",o.id="containermaxtap",t.style.display="none",t.addEventListener("click",e.onComponentClick),t.id="componentmaxtap",t.className="maxtap_component_wrapper",o.appendChild(e.video),o.appendChild(t),null==(n=e.parentElement)||n.appendChild(o),e.video=document.querySelector("[data-displaymaxtap]")}},this.prefetchImage=function(){e.components_data&&(e.components_data[e.current_component_index].is_image_loaded=!0,(new Image).src=e.components_data[e.current_component_index].image_link)},this.canComponentDisplay=function(n){return!!e.components_data&&!(e.components_data[e.current_component_index].start_time<0)&&n>=e.components_data[e.current_component_index].start_time},this.canCloseComponent=function(n){return!e.components_data||!(e.components_data[e.current_component_index].start_time<0)&&n>=e.components_data[e.current_component_index].end_time},this.displayComponent=function(){var n=document.getElementById("componentmaxtap");n&&(n.style.display="flex",n.innerHTML='\n        <div class="maxtap_main" >\n            <p>'+e.components_data[e.current_component_index].caption_regional_language+'</p>\n            <div class="maxtap_img_wrapper">\n                <img src="'+e.components_data[e.current_component_index].image_link+'"/>\n            </div>\n        </div>\n        ',window.gtag("event","watch",{event_category:"impression",event_action:"watch",content_id:e.content_id}))},this.onComponentClick=function(){window.gtag("event","click",{event_category:"action",event_action:"click",content_id:e.content_id,click_time:Math.floor(e.video.currentTime)}),e.components_data&&!e.components_data[e.current_component_index].image_link&&window.open(e.components_data[e.current_component_index].redirect_link,"_blank")},console.log("Hit"),this.content_id=n.content_id,this.parentElement=null;var t=document.createElement("link");t.href="https://unpkg.com/maxtap_plugin_dev@0.1.16/dist/styles.css",t.rel="stylesheet";var o=document.createElement("script");o.src="https://www.googletagmanager.com/gtag/js?id=G-05P2385Q2K",o.async=!0,o.id="G-05P2385Q2K",o.addEventListener("load",(function(){window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-05P2385Q2K")}));var a=document.querySelector("head");null==a||a.appendChild(t),null==a||a.appendChild(o)}return n.prototype.removeCurrentComponent=function(){var n=document.getElementById("componentmaxtap");this.current_component_index>=this.components_data.length&&clearInterval(this.interval_id),n&&(n.style.display="none",n.innerHTML="")},n}();
//# sourceMappingURL=package_name.cjs.production.min.js.map
