"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}("video[data-displaymaxtap]{height:100%;width:100%}.maxtap_component_wrapper{align-self:flex-end;bottom:75px;display:flex;position:absolute;right:0}.maxtap_main{align-items:center;background-color:rgba(0,0,0,.2);cursor:pointer;display:flex;flex-direction:row;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;justify-content:space-between;z-index:10}.maxtap_main>p{color:#fff;font-family:ubuntu,Roboto,sans-serif,Arial,Helvetica;font-size:calc(1vw + .1rem);font-weight:500;margin-left:.2rem;margin-right:.1rem;padding-left:.4rem}.maxtap_img_wrapper{align-items:center;display:flex;justify-content:center;margin-left:.6rem;padding:.3vw;width:6vw}.maxtap_img_wrapper>img{width:100%}");var e=function(){for(var e=document.querySelectorAll("[data-displaymaxtap]"),t=0;t<e.length;t++)if("VIDEO"===e[t].tagName)return e[t];console.error('Cannot find video element,Please check data attribute. It should be data-displaymaxtap\n                   Example: <video src="https://some_source" data-displaymaxtap > </video> \n                            [OR]\n                   Try to initialize the maxtap_ad component after window load.')},t=function(){function t(t){var n=this;this.current_component_index=0,this.init=function(){var t=document.createElement("script");t.src="https://www.googletagmanager.com/gtag/js?id=G-05P2385Q2K",t.async=!0,t.id="G-05P2385Q2K",t.addEventListener("load",(function(){window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config","G-05P2385Q2K")}));var o,a=document.querySelector("head");if(null==a||a.appendChild(t),n.video=e(),n.video)try{(o=n.content_id,new Promise((function(e,t){try{o.includes(".json")||(o+=".json"),fetch("https://storage.googleapis.com/maxtap-adserver-dev.appspot.com/"+o,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){t.json().then((function(t){t.sort((function(e,t){return parseInt(e.start_time)<parseInt(t.start_time)?-1:parseInt(e.start_time)>parseInt(t.start_time)?1:0})),e(t)}))})).catch((function(e){t(e)}))}catch(e){t(e)}}))).then((function(e){n.components_data=e,n.components_data&&(n.initializeComponent(),document.getElementById("componentmaxtap").addEventListener("click",(function(){n.onComponentClick()})),setInterval((function(){n.updateComponent()}),500))})).catch((function(e){console.error(e)}))}catch(e){console.error(e)}else console.error('Cannot find video element,Please check data attribute. It should be data-displaymaxtap\n            Example: <video src="https://some_source" data-displaymaxtap > </video> \n            [OR]\n            Try to initialize the maxtap_ad component after window load.\n            ')},this.updateComponent=function(){if(n.video&&n.components_data){var e=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(t>=o.start_time&&t<=o.end_time)return n}return-1}(n.components_data,n.video.currentTime);e>=0?n.current_component_index=e:n.removeCurrentComponent(),void 0!==n.components_data[n.current_component_index]&&!n.components_data[n.current_component_index].is_image_loaded&&n.components_data[n.current_component_index].start_time-n.video.currentTime<=15&&n.prefetchImage(),n.canComponentDisplay(n.video.currentTime)&&n.displayComponent(),n.canCloseComponent(n.video.currentTime)&&(n.current_component_index++,n.removeCurrentComponent())}else console.error("Cannot find video element with id ")},this.initializeComponent=function(){var t;if(n.video&&(n.video.style.width="100%",n.video.style.height="100%",n.parentElement=n.video.parentElement,n.parentElement)){n.parentElement.style.position="relative";var o=document.createElement("div");o.style.display="none",o.id="componentmaxtap",o.className="maxtap_component_wrapper",null==(t=n.parentElement)||t.appendChild(o);for(var a=0;a<n.components_data.length;a++)n.components_data[a].is_image_loaded=!1;n.video=e()}},this.prefetchImage=function(){n.components_data&&(n.components_data[n.current_component_index].is_image_loaded=!0,(new Image).src=n.components_data[n.current_component_index].image_link)},this.canComponentDisplay=function(e){return!!n.components_data&&!(n.components_data[n.current_component_index].start_time<0)&&e>=n.components_data[n.current_component_index].start_time},this.canCloseComponent=function(e){return!n.components_data||!(n.components_data[n.current_component_index].start_time<0)&&e>=n.components_data[n.current_component_index].end_time},this.displayComponent=function(){var e=document.getElementById("componentmaxtap");if(e){var t='\n        <div class="maxtap_main" >\n        <p>'+n.components_data[n.current_component_index].caption_regional_language+'</p>\n        <div class="maxtap_img_wrapper">\n        <img src="'+n.components_data[n.current_component_index].image_link+'"/>\n        </div>\n        </div>\n        ';"none"===e.style.display&&(e.style.display="flex",e.innerHTML=t),window.gtag("event","watch",{event_category:"impression",event_action:"watch",content_id:n.content_id})}},this.onComponentClick=function(){window.gtag("event","click",{event_category:"action",event_action:"click",content_id:n.content_id,click_time:Math.floor(n.video.currentTime)}),n.components_data&&window.open(n.components_data[n.current_component_index].redirect_link,"_blank")},this.content_id=t.content_id,this.parentElement=null}return t.prototype.removeCurrentComponent=function(){var e=document.getElementById("componentmaxtap");e&&"none"!==e.style.display&&(e.style.display="none",e.innerHTML="")},t}();console.log("maxtap_plugin@0.1.29"),exports.Component=t;
//# sourceMappingURL=maxtap_plugin.cjs.production.min.js.map
